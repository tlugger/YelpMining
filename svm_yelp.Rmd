---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
install.packages("e1071")
library(e1071)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.
```{r}
#Read in the csv data into a data frame
restaurantData <- read.csv("updatedcsv.csv")
```

```{r}
#Only get relevant restaurant data predictors, store in separate data frame
relevantRestaurantDataPredictors <- subset(restaurantData, select = c("business_stars", "sentiment"))

relevantRestaurantDataPredictors$business_stars = round(relevantRestaurantDataPredictors$business_stars)
```
```{r}
#Get classification variable (user rating for a given review)
classificationVariable <- restaurantData$stars
```

```{r}
###Now going to split into training and testing sets###

###NOTE: Training an SVM with 200000 rows is very computationally slow###
##That's why sample 5000 at a given time and apply it to a 1000###
trainIndex <- sample(nrow(restaurantData), 5000)
xTrain <- relevantRestaurantDataPredictors[trainIndex, ]
yTrain <- classificationVariable[trainIndex]


testIndex <- sample(nrow(restaurantData), 2000)
xTest <- relevantRestaurantDataPredictors[testIndex, ]
yTest <- classificationVariable[testIndex]
```

```{r}

#Train the model
dat <- data.frame(x = xTrain, y = as.factor(yTrain))
svmFit <- svm(y ~ ., data = dat)
```

```{r}

#Fit the model and display a truth table
testDat <- data.frame(x = xTest, y = yTest)
yPred <- predict(svmFit, testDat)
table(predict = yPred, truth = yTest)
```




When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).